<!DOCTYPE html>
<html>

<head lang="en">
    <meta charset="UTF-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">

    <title>GrokAlign</title>

    <meta name="description" content="GrokAlign">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.8.0/codemirror.min.css">
    <link rel="stylesheet" href="css/app.css">

    <link rel="stylesheet" href="css/bootstrap.min.css">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.8.0/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.5.3/clipboard.min.js"></script>
    
    <script src="js/app.js"></script>

    <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
    
</head>

<body>
    <div class="container" id="main">
        <div class="row">
            <h2 class="text-center">
                <b>GrokAlign</b>: Geometric Characterisation and Acceleration of Grokking
                <small>
                    
                </small>
            </h2>
        </div>
        <div class="row">
            <div class="text-center">
                <ul class="list-inline">
                    <li>
                        <a href="https://thomaswalker1.github.io/">
                          Thomas Walker
                        </a>
                        </br>Rice University
                    </li>
                    <li>
                        <a href="https://imtiazhumayun.github.io">
                          Ahmed Imtiaz Humayun
                        </a>
                        </br>Rice University
                    </li>
                    <li>
                        <a href="https://randallbalestriero.github.io/">
                            Randall Balestriero
                        </a>
                        </br>Brown University
                    </li>
                    <li>
                        <a href="https://richb.rice.edu/">
                          Richard Baraniuk
                        </a>
                        </br>Rice University
                    </li>
                </ul>
            </div>
        </div>
        <div class="row">
            <div class="col-md-4 col-md-offset-4 text-center" style="display: flex;justify-content: space-evenly;padding: 24px 0;">
                <div style="text-align: center; margin-right: 10px;">
                    <a href="https://arxiv.org/abs/2506.12284" style="text-decoration: none;">
                        <img src="img/paper_logo.jpg" alt="logo" height="60px" style="
                            border-style: solid;
                            border-width: thin;
                            border-color: black;
                        ">
                        <h4><strong>Paper</strong></h4>
                    </a>
                </div>
                <div style="text-align: center; margin-right: 10px;">
                    <a href="https://github.com/ThomasWalker1/grokalign" style="text-decoration: none;">
                        <img src="img/github.png" alt="logo" height="60px">
                        <h4><strong>Code<br></strong></h4>
                    </a>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-8 col-md-offset-2">
                <div style="text-align: center; width: 100%;">
                    <img src="assets/centroid_alignment_grokking_summary.png" style="width: 100%; height: auto; margin-bottom: 10px;">
                </div>
                <h2>Abstract</h2>
                <p class="text-justify">
                    A key challenge for the machine learning community is to understand and accelerate the training dynamics of deep networks that lead to delayed generalisation and emergent robustness to input perturbations, also known as grokking. Prior work has associated phenomena like delayed generalisation with the transition of a deep network from a linear to a feature learning regime, and emergent robustness with changes to the network's functional geometry, in particular the arrangement of the so-called linear regions in deep networks employing continuous piecewise affine nonlinearities. Here, we explain how grokking is realised in the Jacobian of a deep network and demonstrate that aligning a network's Jacobians with the training data (in the sense of cosine similarity) ensures grokking under a low-rank Jacobian assumption. Our results provide a strong theoretical motivation for the use of Jacobian regularisation in optimizing deep networks -- a method we introduce as GrokAlign -- which we show empirically to induce grokking much sooner than more conventional regularizers like weight decay. Moreover, we introduce centroid alignment as a tractable and interpretable simplification of Jacobian alignment that effectively identifies and tracks the stages of deep network training dynamics.
                </p>
                <div style="text-align: center; width: 100%;display: flex; justify-content: center;">
                    <figure style="width: 30%;">
                        <img src="assets/inputs_mnist.png" style="width: 100%; height: auto; margin-bottom: 10px;">
                        <figcaption>Data Points</figcaption>
                    </figure>

                    <figure style="width: 30%;">
                        <img src="assets/unaligned_mnist.png" style="width: 100%; height: auto; margin-bottom: 10px;">
                        <figcaption>Centroids at Memorisation</figcaption>
                    </figure>

                    <figure style="width: 30%;">
                        <img src="assets/aligned_mnist.png" style="width: 100%; height: auto; margin-bottom: 10px;">
                        <figcaption>Centroids at Generalisation</figcaption>
                    </figure>
                </div>
                <p>
                    <b>Fig:</b> For deep networks to grok, their Jacobians should align such that the sum of their rows is cosine-similar to the point at which they were computed; we dub this condition centroid aligned. This has consequences on the functional geometry of deep networks through the Spline Theory of Deep Learning. Here we train a ReLU network on the MNIST dataset using GrokAlign, which is a method for regularising the Jacobian matrices of a deep network during training. We take three training data points, <b>left</b>, and observe the linear regions (using <a href="https://imtiazhumayun.github.io/splinecam/">SplineCam</a>) of the deep network along with the centroids of the three data points when it has memorized the training data, <b>centre</b>, and when it has generalised, <b>right</b>. We colour the linear regions according to the norm of the linear operator acting upon them.
                </p>
            </div>
        </div>

        <div class="row">
            <div class="col-md-8 col-md-offset-2">
                <h3>Jacobian and Centroid Alignment</h3>
                <p class="text-justify">
                    <u><strong>Definition:</strong></u> A deep network is <b><em>Jacobian-aligned</em></b> at point if its rows are scalar multiples of that point.
                </p>
                <p style="padding: 0 20px;">
                    Jacobian aligned deep networks <b>optimize the training objective</b> on a constrained set.
                </p>
                <p style="padding: 0 20px;">
                    Jacobian aligned deep networks are <b>optimally robust</b> on local regions of the input space.
                </p>
                <p>
                    <u><strong>Definition:</strong></u> A <b><em>centroid</em></b> at a point is equal to the sum of the rows of the Jacobian.
                </p>
                <p style="padding: 0 20px;">
                    Centroids <b>parametrise the functional geometry</b> of deep networks.
                </p>
                <p>
                    <u><strong>Proposition:</strong></u> Jacobian alignment implies <b><em>centroid alignment.</em></b>
                </p>
                <p style="padding: 0 20px;">
                    Centroid alignment <b>identifies the feature learning</b> of deep networks.
                </p>
                <p style="padding: 0 20px;">
                    Centroid alignment <b>efficiently</b> captures the training dynamics of deep networks.
                </p>
                    <div style="text-align: center; width: 100%;">
                    <img src="assets/jacobian_alignment.png" style="width: 100%; height: auto; margin-bottom: 10px;">
                    </div>
                </div>
            </div>

        <div class="row">
            <div class="col-md-8 col-md-offset-2">
                <h3>Centroid Alignment Identifies Feature Learning</h3>
                <div style="text-align: center; width: 100%;">
                    <img src="assets/centroid_alignment_feature_learning.png" style="width: 100%; height: auto; margin-bottom: 10px;">
                </div>
                <p class="text-justify">
                    <b>Fig:</b> Using the neural tangent kernel, we demonstrate theoretically that a changing inner product between a centroid and the point it was computed at represents the feature learning regime of deep network training; when translated into a changing alignment we see the generalisation of a deep networks learned representations. Here we train a two-layer scalar-output ReLU network to distinguish between the zero and one class of the MNIST dataset. For a point in the training set we monitor the inner product and alignment (cosine similarity) to its corresponding centroid, which is computed efficiently through a Jacobian vector product. By also monitoring the neural tangent kernel, we support our theoretical conclusion that a changing inner product corresponds to the feature learning regime of training. Furthermore, we note that the factor inhibiting centroid alignment, which is an artefact of an optimal deep network, is the norm of the centroid.
                </p>
                <h3>Centroid Alignment Identifies Robustness</h3>
                <div style="text-align: center; width: 100%;">
                    <img src="assets/centroid_alignment_robustness.png" style="width: 100%; height: auto; margin-bottom: 10px;">
                </div>
                <p class="text-justify">
                    <b>Fig:</b> Since Jacobian alignment is a necessary condition for deep network robustness under a low-rank Jacobian assumption, it follows that centroid alignment is a artifact of a robustness deep network. Here we demonstrate that a higher centroid alignment corresponds to a more robust deep network. More specifically, we consider the XOR grokking set up of Xu et al. (2025) and monitor the centroid alignment and robustness of the deep network through training. In the <b>top</b> row we use weight-decay, whereas in the <b>bottom</b> row we also use GrokAlign. We see that by using GrokAlign, the norm of the centroid is maintained at a relatively lower value allowing it to become aligned which correlates with the accelerate onset of robustness.
                </p>
            </div>
        </div>

        <div class="row">
            <div class="col-md-8 col-md-offset-2">
                <h3>GrokAlign Induces Alignment and Thus Accelerates Grokking</h3>
                <p class="text-justify">
                    <b>GrokAlign</b> is our solution to the observation that standard deep network training techniques do not maintain a low Jacobian norm which inhibits their alignment and thus grokking. GrokAlign regularises the Frobenius norms of the Jacobians of a deep network on the training data during training by appending their values to the loss function with some weighting coefficient. 
                </p>
                <video autoplay="" muted="" loop="" playsinline="" playbackrate="2" width="100%" style="max-height: 400px;padding-right: 5px;width: 100%;">
                    <source src="assets/centroid_alignment.mp4" type="video/mp4">
                </video>
                <p class="text-justify">
                    <b>Fig:</b> Using GrokAlign significantly accelerates the rate of grokking. In our paper we perform a study which determines this speed up factor can be up to 7 times faster. We assume the MNIST grokking set up of Liu et al.(2022) in the <b>top</b> row, and we additionally utilise GrokAlign in the <b>bottom</b> row. Clearly, grokking occurs earlier in the model trained with GrokAlign. To the <b>right</b> of each accuracy plot we visualise the centroid of a point from the training set. We observe that during the grokking phase the centroid develops a structure which under GrokAlign is more resemblant of the training point, this is centroid alignment.
                </p>
            </div>
        </div>

        <div class="row">
            <div class="col-md-8 col-md-offset-2">
                <h3>
                    Citation
                </h3>
                <div class="form-group col-md-10 col-md-offset-1">
                    <textarea id="bibtex" class="form-control" readonly>
@misc{walkerGrokAlignGeometricCharacterisation2025,
  title = {{{GrokAlign}}: {{Geometric}} Characterisation and Acceleration of Grokking},
  author = {Walker, Thomas and Humayun, Ahmed Imtiaz and Balestriero, Randall and Baraniuk, Richard},
  year = {2025},
  eprint = {2506.12284},
  archiveprefix = {arXiv}
}

@inproceedings{walkerJacobianAlignmentExplains2025,
  title = {Jacobian {{Alignment Explains Grokking}} and {{Centroid Alignment Identifies It}}},
  booktitle = {High-Dimensional {{Learning Dynamics}} 2025},
  author = {Walker, Thomas and Humayun, Ahmed Imtiaz and Balestriero, Randall and Baraniuk, Richard},
  year = {2025},
  month = jun,
}
                    </textarea>
                </div>
            </div>
        </div>
    </body>
</html>